# ごみ出し予報 (Gomidashi Yoho)

Googleスプレッドシートをあなた専用のデータベースとして利用する、個人特化型のLINEリマインダーBotです。

## 概要

「あれ、今日のゴミってなんだっけ？」を解決するために開発された、パーソナルなゴミ出し日管理Botです。LINEアカウントさえあれば、誰でも直感的なインターフェースを通じて自身のゴミの収集日を確認・登録・変更できます。

バックエンドはGoogle Apps Script（GAS）で構築されており、サーバーレスで低コストな運用が可能です。家族や友人など、クローズドなコミュニティでの利用を想定しています。

## 主な機能 ✨

  * **ワンタップでのスケジュール編集**: 「全部」と送信すると、1週間の予定がカルーセルで表示されます。**変更したい曜日をタップするだけ**で、すぐに対話形式の編集モードに移行。コマンドを覚える必要はありません。

  * **シンプルなゴミ出し日確認**: 「今日」「明日」とキーワードを送るだけで、その日のゴミ出し予定を瞬時に返信します。「詳細」と付け加えれば、登録した注意事項もあわせて確認できます。

  * **スマートな利用開始フロー**:

      * **新規ユーザー**: 「はじめる」と送信するだけで、あなた専用のデータ領域が自動で作成されます。
      * **再開ユーザー**: Botをブロック後、再追加しても過去のデータを認識し、スムーズな利用再開を促します。

  * **安定した運用設計**:

      * Webhook URLに含めた秘密トークンにより、第三者からの不正なリクエストをブロックします。
      * 連続タップによるサーバーへの意図しないリクエストを無視するロック機能を搭載し、安定した動作を実現します。

## 使い方 📝

Botの操作はとてもシンプルです。

1.  Botに「**全部**」とメッセージを送ります。
2.  月曜日から日曜日までのスケジュールが、横にスクロールできるカルーセル形式で表示されます。
3.  予定を変更したい曜日（例：「火曜日」）のカードを**タップ**します。
4.  Botが「現在の品目は〜」と質問してくるので、案内に従って新しい品目や注意事項を送信すれば、更新が完了します。

## 技術スタック 🛠️

  * **プラットフォーム**: LINE Messaging API
  * **バックエンド**: Google Apps Script (GAS)
  * **データベース**: Google Sheets
  * **ローカル開発**: Visual Studio Code + clasp


## セットアップ

1.  **LINE Developers Consoleでの設定**

      * プロバイダーとMessaging APIチャネルを作成します。
      * `チャネルアクセストークン` を取得します。（チャネルシークレットはGASのコードでは使用しません）

2.  **Google Sheetsの準備**

      * 新規にGoogleスプレッドシートを1つ作成し、`スプレッドシートID` を控えます。
      * シート名を `Users` と `Schedules` に変更し、それぞれ以下のヘッダーを1行目に設定します。
          * **Users**: `userId`, `status`, `createdAt`, `updatedAt`
          * **Schedules**: `userId`, `dayOfWeek`, `itemName`, `notes`

3.  **秘密トークンの準備**

      * Webhook URLの認証に使う、推測されにくいランダムな文字列（例: `aK7b-n9Xz-Pq3R-sT8V`など）を自分で作成します。

4.  **Google Apps Script (GAS)プロジェクトの設定**

      * GASプロジェクトを新規作成し、このリポジトリのコードを各ファイルにコピーします。
      * `clasp` を利用してローカルからプッシュすることも可能です。
      * スクリプトプロパティに以下のキーと値を設定します。
          * `LINE_CHANNEL_ACCESS_TOKEN`
          * `SECRET_TOKEN` （手順3で準備した秘密トークン）
          * `DATABASE_SHEET_ID` （準備したスプレッドシートのID）
          * `LOG_ID` （ログ記録用の別スプレッドシートのID）

5.  **デプロイとWebhook設定**

      * GASプロジェクトを「ウェブアプリ」としてデプロイし、ウェブアプリURLを取得します。
      * LINE Developers ConsoleのWebhook設定に、取得したURLの末尾に `?token=【設定した秘密トークン】` を追加したものを貼り付け、「Webhookの利用」をオンにします。
      * **設定例**: `https://script.google.com/macros/s/xxxx/exec?token=aK7b-n9Xz-Pq3R-sT8V`

## 利用規約とライセンス

本サービスの利用規約およびプライバシーポリシーについては、以下のページをご確認ください。

* **[利用規約・プライバシーポリシー](./policy.md)**

また、本プロジェクトのソースコードはMIT Licenseのもとで公開されています。
